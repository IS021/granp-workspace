<ion-header>
    <ion-toolbar>
      <ion-buttons slot="start">
        <ion-back-button text=" " defaultHref="/tabs/chats"></ion-back-button>
      </ion-buttons>

      <ion-title>
        <div class="profile-bar">
            <ion-avatar>
                <img *ngIf="chat?.profilePicture !== null" [src]="chat?.profilePicture"/>
                <img *ngIf="chat?.profilePicture === null" src="/assets/default-profile-picture.png"/>
            </ion-avatar>
            <ion-text class="title">{{ chat?.name }}</ion-text>
        </div>
      </ion-title>
    </ion-toolbar>
  </ion-header>
  
  <ion-content>
    <ion-list lines="none" class="chat-list">
      <ion-item *ngFor="let message of chat?.messages, index as i">
        <div
            [classList]="getMessageClass(i) + ' message'"
            [slot]="message.sender === 'user' ? 'end' : 'start'"
        >
            <ion-text>{{ message.content }}</ion-text>
            <ion-note [color]="message.sender === 'user' ? 'dark' : 'medium'">
                {{ message.time.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}) }}
            </ion-note>
        </div>
      </ion-item>
    </ion-list>
  </ion-content>
  
  <ion-footer>
    <ion-toolbar>
        <ion-textarea
            mode="ios"
            placeholder="Scrivi un messaggio..."
            [(ngModel)]="message"
            (keyup.enter)="sendMessage()"
            maxlength="256"
            [autoGrow]="true"
            [rows]="1"
        ></ion-textarea>
        <ion-buttons slot="end">
            <ion-button (click)="sendMessage()">
                <ion-icon slot="icon-only" name="send"></ion-icon>
            </ion-button>
        </ion-buttons>
    </ion-toolbar>
  </ion-footer>